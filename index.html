<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Run Daddles, Run</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 50%, #f97316 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .shoe-icon {
            font-size: 1.2em;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        .card {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 12px 40px rgba(0,0,0,0.15);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(249, 115, 22, 0.3);
        }

        .input-section {
            text-align: center;
        }

        .input-section h2 {
            margin-bottom: 20px;
            color: #4a5568;
        }

        .date-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            margin-bottom: 15px;
            background: white;
        }

        .distance-input-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .distance-input {
            width: 100px;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 18px;
            text-align: center;
            background: white;
        }

        .km-label {
            font-size: 18px;
            font-weight: 600;
            color: #4a5568;
        }

        .btn {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            font-weight: 600;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.5);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f97316, #ea580c);
            color: white;
            box-shadow: 0 4px 15px rgba(249, 115, 22, 0.4);
            margin-top: 10px;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(249, 115, 22, 0.5);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            border: 2px solid rgba(59, 130, 246, 0.2);
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #1e40af;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .streak-section {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #dbeafe 0%, #fed7aa 100%);
            border-radius: 15px;
            margin-bottom: 20px;
            border: 2px solid rgba(249, 115, 22, 0.3);
        }

        .streak-number {
            font-size: 36px;
            font-weight: 800;
            color: #ea580c;
            margin-bottom: 5px;
        }

        .streak-label {
            font-size: 14px;
            color: #1e40af;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .recent-runs {
            max-height: 200px;
            overflow-y: auto;
        }

        .run-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .run-item:last-child {
            border-bottom: none;
        }

        .run-date {
            font-weight: 600;
            color: #4a5568;
        }

        .run-distance {
            font-size: 16px;
            color: #1e40af;
            font-weight: 600;
        }

        .delete-btn {
            background: #f97316;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 4px 8px;
            font-size: 12px;
            cursor: pointer;
            margin-left: 10px;
        }

        .delete-btn:hover {
            background: #ea580c;
        }

        .message {
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
            font-weight: 600;
        }

        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }
            
            .card {
                padding: 20px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                <span class="shoe-icon">ðŸ‘Ÿ</span>
                Run Daddles, Run
                <span class="shoe-icon">ðŸ‘Ÿ</span>
            </h1>
        </div>

        <div class="card">
            <div class="input-section">
                <h2>Log Your Run</h2>
                <input type="date" id="runDate" class="date-input">
                <div class="distance-input-container">
                    <input type="number" id="distance" class="distance-input" placeholder="0" step="0.1" min="0">
                    <span class="km-label">km</span>
                </div>
                <button onclick="addRun()" class="btn btn-primary">Add Run</button>
                <button onclick="clearAllData()" class="btn btn-secondary">Clear All Data</button>
            </div>
        </div>

        <div id="message"></div>

        <div class="card">
            <div class="streak-section">
                <div class="streak-number" id="currentStreak">0</div>
                <div class="streak-label">Day Streak</div>
            </div>
        </div>

        <div class="card">
            <h2 style="text-align: center; margin-bottom: 20px; color: #4a5568;">Statistics</h2>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-value" id="totalDistance">0.0</div>
                    <div class="stat-label">Total km</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="weekDistance">0.0</div>
                    <div class="stat-label">This Week</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="monthDistance">0.0</div>
                    <div class="stat-label">This Month</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalRuns">0</div>
                    <div class="stat-label">Total Runs</div>
                </div>
            </div>
        </div>

        <div class="card">
            <h2 style="text-align: center; margin-bottom: 20px; color: #4a5568;">Recent Runs</h2>
            <div class="recent-runs" id="recentRuns">
                <p style="text-align: center; color: #718096;">No runs logged yet</p>
            </div>
        </div>
    </div>

    <script>
        let runs = [];

        // Initialize the app
        function init() {
            // Set today's date as default
            document.getElementById('runDate').value = new Date().toISOString().split('T')[0];
            
            // Load saved data
            loadData();
            updateDisplay();
        }

        // Save data to in-memory storage
        function saveData() {
            // Note: Using in-memory storage instead of localStorage for artifact compatibility
            console.log('Data saved:', runs);
        }

        // Load data from in-memory storage
        function loadData() {
            // Note: In artifacts, data persists only during the session
            console.log('Data loaded:', runs);
        }

        // Add a new run
        function addRun() {
            const dateInput = document.getElementById('runDate');
            const distanceInput = document.getElementById('distance');
            
            const date = dateInput.value;
            const distance = parseFloat(distanceInput.value);

            if (!date) {
                showMessage('Please select a date', 'error');
                return;
            }

            if (!distance || distance <= 0) {
                showMessage('Please enter a valid distance', 'error');
                return;
            }

            // Check if run already exists for this date
            const existingRunIndex = runs.findIndex(run => run.date === date);
            
            if (existingRunIndex !== -1) {
                // Update existing run
                runs[existingRunIndex].distance = distance;
                showMessage('Run updated successfully!', 'success');
            } else {
                // Add new run
                runs.push({ date, distance });
                showMessage('Run added successfully!', 'success');
            }

            // Sort runs by date (newest first)
            runs.sort((a, b) => new Date(b.date) - new Date(a.date));

            // Clear input
            distanceInput.value = '';
            
            saveData();
            updateDisplay();
        }

        // Delete a run
        function deleteRun(date) {
            runs = runs.filter(run => run.date !== date);
            saveData();
            updateDisplay();
            showMessage('Run deleted', 'success');
        }

        // Calculate current streak
        function calculateStreak() {
            if (runs.length === 0) return 0;

            // Get unique dates and sort them (newest first)
            const uniqueDates = [...new Set(runs.map(run => run.date))].sort((a, b) => new Date(b) - new Date(a));
            
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            let streak = 0;
            let checkDate = new Date(today);

            // Check if we ran today or yesterday to start the streak
            let streakStarted = false;
            
            for (let dateStr of uniqueDates) {
                const runDate = new Date(dateStr + 'T12:00:00'); // Add noon time to avoid timezone issues
                runDate.setHours(0, 0, 0, 0);
                
                const daysDiff = Math.floor((checkDate - runDate) / (1000 * 60 * 60 * 24));
                
                if (daysDiff === 0) {
                    // Ran on checkDate
                    streak++;
                    streakStarted = true;
                    checkDate.setDate(checkDate.getDate() - 1);
                } else if (daysDiff === 1 && streakStarted) {
                    // Ran the day before, continue streak
                    streak++;
                    checkDate.setDate(checkDate.getDate() - 1);
                } else if (daysDiff === 1 && !streakStarted) {
                    // First run was yesterday, start streak
                    streak++;
                    streakStarted = true;
                    checkDate.setDate(checkDate.getDate() - 1);
                } else if (daysDiff > 1) {
                    // Gap in streak
                    break;
                }
            }

            return streak;
        }

        // Calculate distances for different periods
        function calculateDistances() {
            const today = new Date();
            today.setHours(23, 59, 59, 999); // End of today
            
            // Calculate start of this week (Sunday)
            const thisWeekStart = new Date(today);
            thisWeekStart.setDate(today.getDate() - today.getDay());
            thisWeekStart.setHours(0, 0, 0, 0);

            // Calculate start of this month
            const thisMonthStart = new Date(today.getFullYear(), today.getMonth(), 1);
            thisMonthStart.setHours(0, 0, 0, 0);

            let total = 0;
            let week = 0;
            let month = 0;

            runs.forEach(run => {
                const runDate = new Date(run.date + 'T12:00:00'); // Add noon time to avoid timezone issues
                const distance = parseFloat(run.distance) || 0;
                
                total += distance;

                // Check if run is in current week
                if (runDate >= thisWeekStart && runDate <= today) {
                    week += distance;
                }

                // Check if run is in current month
                if (runDate >= thisMonthStart && runDate <= today) {
                    month += distance;
                }
            });

            return { 
                total: Math.round(total * 10) / 10, 
                week: Math.round(week * 10) / 10, 
                month: Math.round(month * 10) / 10 
            };
        }

        // Update the display
        function updateDisplay() {
            const distances = calculateDistances();
            const streak = calculateStreak();

            // Update statistics
            document.getElementById('totalDistance').textContent = distances.total.toFixed(1);
            document.getElementById('weekDistance').textContent = distances.week.toFixed(1);
            document.getElementById('monthDistance').textContent = distances.month.toFixed(1);
            document.getElementById('totalRuns').textContent = runs.length;
            document.getElementById('currentStreak').textContent = streak;

            // Update recent runs
            const recentRunsDiv = document.getElementById('recentRuns');
            if (runs.length === 0) {
                recentRunsDiv.innerHTML = '<p style="text-align: center; color: #718096;">No runs logged yet</p>';
            } else {
                const recentRuns = runs.slice(0, 10); // Show last 10 runs
                recentRunsDiv.innerHTML = recentRuns.map(run => `
                    <div class="run-item">
                        <span class="run-date">${formatDate(run.date)}</span>
                        <div>
                            <span class="run-distance">${run.distance.toFixed(1)} km</span>
                            <button class="delete-btn" onclick="deleteRun('${run.date}')">âœ•</button>
                        </div>
                    </div>
                `).join('');
            }
        }

        // Format date for display - FIXED VERSION
        function formatDate(dateString) {
            // Split the date string to avoid timezone issues
            const [year, month, day] = dateString.split('-').map(num => parseInt(num));
            
            // Create date object using local timezone
            const date = new Date(year, month - 1, day); // month is 0-indexed
            
            return date.toLocaleDateString('en-US', { 
                weekday: 'short', 
                month: 'short', 
                day: 'numeric' 
            });
        }

        // Show message to user
        function showMessage(text, type) {
            const messageDiv = document.getElementById('message');
            messageDiv.innerHTML = `<div class="message ${type}">${text}</div>`;
            
            setTimeout(() => {
                messageDiv.innerHTML = '';
            }, 3000);
        }

        // Clear all data
        function clearAllData() {
            if (confirm('Are you sure you want to delete all your running data? This cannot be undone.')) {
                runs = [];
                saveData();
                updateDisplay();
                showMessage('All data cleared', 'success');
            }
        }

        // Initialize the app when page loads
        init();
    </script>
</body>
</html>
